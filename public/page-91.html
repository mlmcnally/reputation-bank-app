<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Exercise 12 ‚Äì Page 91</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <style>
    body {
      font-family: 'Avenir', 'Nunito Sans', sans-serif;
      background: #f3f4f6;
      padding: 2rem;
      margin: 0;
      color: #000;
    }

    h2 { text-align: center; color: #084a58; }

    .form-note {
      color: #084a58;
      text-align: center;
      margin-bottom: 1rem;
    }

    /* Layout proportions */
    .container {
      display: flex;
      gap: 1rem;            /* tight, consistent gap */
      align-items: flex-start;
    }
    .left-pane {
      flex: 0 0 45%;
      max-width: 45%;
    }
    .left-pane img {
      width: 100%;
      height: auto;
      border-radius: 8px;
      border: 1px solid #ccc;
      display: block;
    }
    .right-pane {
      flex: 1 1 55%;
      max-width: 55%;
    }

    /* Card */
    .card {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    .instructions {
      background: #fff;
      padding: 14px;
      border: 1px solid #ccc;
      border-radius: 6px;
      margin-bottom: 12px;
    }

    .reference-list {
      background: #eef2f7;
      padding: 10px 14px;
      border: 1px solid #ccc;
      border-radius: 6px;
      margin-bottom: 12px;
    }
    .reference-list ul {
      margin: 0.5rem 0 0;
      padding-left: 1.25rem;
    }

    label { font-weight: 700; color: #084a58; display: block; margin: 12px 0 6px; }

    textarea {
      width: 100%;
      min-height: 60px;
      padding: 8px;
      border-radius: 4px;
      border: 1px solid #ccc;
      font-size: 1rem;
      resize: vertical;
      box-sizing: border-box;
    }

    /* Buttons */
    .button-group {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 1rem;
    }
    .button-group button {
      flex: 1;
      min-width: 160px;
      background-color: #084a58;
      color: #fff;
      border: none;
      padding: 10px 16px;
      border-radius: 4px;
      cursor: pointer;
      box-shadow: 2px 2px 4px rgba(0,0,0,0.3);
      font-size: 0.95rem;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
    }
    .button-group button:hover { opacity: 0.9; }

    #status {
      margin-top: 1rem;
      text-align: center;
      font-weight: bold;
      color: #084a58; /* dark teal */
    }
  </style>
</head>
<body>
  <h2>Exercise 12 ‚Äì Page 91</h2>
  <div class="form-note">
    Distinguish between <strong>Credibility Debt</strong> (shorter-term risks) and <strong>Credibility Cryptocurrency</strong> (longer-term risks) using your ‚ÄúDon‚Äôts‚Äù from Exercise 6.
  </div>

  <div class="container">
    <div class="left-pane">
      <img src="/page-91.jpg" alt="Exercise 12 Page 91" />
    </div>

    <div class="right-pane">
      <div class="card">
        <div class="instructions">
          <strong>Now we‚Äôre going to consider the credibility risks that can negatively impact your reputation bank.</strong>
          <p>See below the work you did in Exercise 6 on the ‚ÄúDon‚Äôts‚Äù of the Success Rules. Consider the difference between <strong>Credibility Debt</strong> (shorter-term reputation risk) and <strong>Credibility Cryptocurrency</strong> (longer-term reputation risk). Determine which of the ‚ÄúDon‚Äôts‚Äù are Credibility Debt and which are Credibility Cryptocurrency and type them in the appropriate spaces below. You‚Äôll need three of each type to move to the next exercises. If you don‚Äôt have enough of one type, it‚Äôs a good idea to go back to Exercise 6, Page 54 and re-consider your risks using this lens.</p>
          <p><strong>Tip:</strong> You‚Äôve completed the positive side of the Reputation Bank ‚Äì Credibility Cash and Gold. Now, distinguish negative impacts based on how much repetitive harm could occur over time.</p>
        </div>

        <div class="reference-list" id="referenceList">
          <strong>Your Don‚Äôts from Exercise 6:</strong>
          <ul id="dontList"></ul>
        </div>

        <div class="section">
          <label>Credibility Debt (Hypothetical Shorter-Term Reputation Risks)</label>
          <textarea id="debt1" placeholder="Debt example #1"></textarea>
          <textarea id="debt2" placeholder="Debt example #2"></textarea>
          <textarea id="debt3" placeholder="Debt example #3"></textarea>
        </div>

        <div class="section">
          <label>Credibility Cryptocurrency (Hypothetical Longer-Term Reputation Risks)</label>
          <textarea id="crypto1" placeholder="Cryptocurrency example #1"></textarea>
          <textarea id="crypto2" placeholder="Cryptocurrency example #2"></textarea>
          <textarea id="crypto3" placeholder="Cryptocurrency example #3"></textarea>
        </div>

        <div class="button-group">
          <button type="button" onclick="goBack()">‚¨Ö Back One Page</button>
          <button type="button" onclick="saveData(false)">üíæ Save</button>
          <button type="button" onclick="saveData(true)">‚û° Save & Next</button>
          <button type="button" onclick="window.print()">üñ®Ô∏è Print</button>
          <button type="button" onclick="goToTOC()">Go to the Table of Contents</button>
        </div>

        <div id="status"></div>
      </div>
    </div>
  </div>

  <script>
    const supabase = window.supabase.createClient(
      'https://nidxvthbowdgdfuopmzk.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5pZHh2dGhib3dkZ2RmdW9wbXprIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQxNTYwMjgsImV4cCI6MjA1OTczMjAyOH0.EaRbqF0WYFzYfjL5A6ykQKzHCZzCNPWJINIVwosqYk4'
    );

    async function loadData() {
      const { data: { user } } = await supabase.auth.getUser();
      if (!user) return;

      // Load saved answers for page 91
      const { data: savedData } = await supabase
        .from('exercise12_page91')
        .select('*')
        .eq('user_id', user.id)
        .single();

      if (savedData) {
        document.getElementById('debt1').value = savedData.debt1 || '';
        document.getElementById('debt2').value = savedData.debt2 || '';
        document.getElementById('debt3').value = savedData.debt3 || '';
        document.getElementById('crypto1').value = savedData.crypto1 || '';
        document.getElementById('crypto2').value = savedData.crypto2 || '';
        document.getElementById('crypto3').value = savedData.crypto3 || '';
      }

      // Load Don‚Äôts from Exercise 6 (page 54)
      const { data: exercise6Data } = await supabase
        .from('exercise6_page54')
        .select('*')
        .eq('user_id', user.id)
        .single();

      const dontList = document.getElementById('dontList');
      dontList.innerHTML = '';

      if (exercise6Data) {
        for (let i = 1; i <= 10; i++) {
          const value = exercise6Data[`success_dont_${i}`];
          if (value && value.trim() !== '') {
            const li = document.createElement('li');
            li.textContent = value;
            dontList.appendChild(li);
          }
        }
      }
    }

    async function saveData(goNext = false) {
      const status = document.getElementById('status');
      status.textContent = '';
      status.style.color = '#084a58';

      const { data: { user } } = await supabase.auth.getUser();
      if (!user) {
        status.textContent = '‚ùå User not logged in.';
        status.style.color = 'red';
        return;
      }

      // Enforce 3 + 3 if going next
      if (goNext) {
        const debts = ['debt1','debt2','debt3'].map(id => document.getElementById(id).value.trim());
        const cryptos = ['crypto1','crypto2','crypto3'].map(id => document.getElementById(id).value.trim());
        const debtFilled = debts.every(v => v.length > 0);
        const cryptoFilled = cryptos.every(v => v.length > 0);
        if (!debtFilled || !cryptoFilled) {
          status.textContent = '‚ùå Please enter three Credibility Debt items and three Credibility Cryptocurrency items before continuing.';
          status.style.color = 'red';
          return;
        }
      }

      const updates = {
        user_id: user.id,
        debt1: document.getElementById('debt1').value.trim(),
        debt2: document.getElementById('debt2').value.trim(),
        debt3: document.getElementById('debt3').value.trim(),
        crypto1: document.getElementById('crypto1').value.trim(),
        crypto2: document.getElementById('crypto2').value.trim(),
        crypto3: document.getElementById('crypto3').value.trim(),
      };

      const { error } = await supabase
        .from('exercise12_page91')
        .upsert([updates], { onConflict: ['user_id'] });

      if (error) {
        status.textContent = '‚ùå Error saving data: ' + error.message;
        status.style.color = 'red';
      } else {
        status.textContent = 'Saved successfully!';
        status.style.color = '#084a58';
        if (goNext) window.location.href = '/#page/92';
      }
    }

    function goBack() { window.location.href = '/#page/90'; }
    function goToTOC() { window.location.href = '/page-3.html'; }

    document.addEventListener('DOMContentLoaded', loadData);
  </script>
</body>
</html>
