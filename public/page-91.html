<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Exercise 12 ‚Äì Page 91</title>

  <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <style>
    body {
      font-family: "Avenir", "Nunito Sans", sans-serif;
      background: #f3f4f6;
      padding: 2rem;
      margin: 0;
      color: #000;
    }

    h2 { text-align: center; color: #084a58; }

    .form-note {
      color: #084a58;
      text-align: center;
      margin-bottom: 1rem;
      max-width: 900px;
      margin-left: auto;
      margin-right: auto;
    }

    /* Layout proportions */
    .container {
      display: flex;
      gap: 1rem;
      align-items: flex-start;
    }
    .left-pane {
      flex: 0 0 45%;
      max-width: 45%;
    }
    .left-pane img {
      width: 100%;
      height: auto;
      border-radius: 8px;
      border: 1px solid #ccc;
      display: block;
    }
    .right-pane {
      flex: 1 1 55%;
      max-width: 55%;
    }

    /* Card */
    .card {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    .instructions {
      background: #fff;
      padding: 14px;
      border: 1px solid #ccc;
      border-radius: 6px;
      margin-bottom: 12px;
    }

    .reference-list {
      background: #eef2f7;
      padding: 10px 14px;
      border: 1px solid #ccc;
      border-radius: 6px;
      margin-bottom: 12px;
    }
    .reference-list ul {
      margin: 0.5rem 0 0;
      padding-left: 1.25rem;
    }

    label {
      font-weight: 700;
      color: #084a58;
      display: block;
      margin: 12px 0 6px;
    }

    textarea {
      width: 100%;
      min-height: 60px;
      padding: 8px;
      border-radius: 4px;
      border: 1px solid #ccc;
      font-size: 1rem;
      resize: vertical;
      box-sizing: border-box;

      /* ‚úÖ Critical: keep typed + autofilled text font consistent */
      font-family: inherit;
      color: #000;
    }

    textarea::placeholder { color: #6b7280; }

    /* Buttons */
    .button-group {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 1rem;
    }
    .button-group button {
      flex: 1;
      min-width: 160px;
      background-color: #084a58;
      color: #fff;
      border: none;
      padding: 10px 16px;
      border-radius: 4px;
      cursor: pointer;
      box-shadow: 2px 2px 4px rgba(0,0,0,0.3);
      font-size: 0.95rem;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;

      /* ‚úÖ Keep button text font consistent */
      font-family: inherit;
    }
    .button-group button:hover { opacity: 0.9; }

    #status {
      margin-top: 1rem;
      text-align: center;
      font-weight: bold;
      color: #084a58;
      white-space: pre-wrap;
    }
  </style>
</head>

<body>
  <h2>Exercise 12 ‚Äì Page 91</h2>
  <div class="form-note">
    Distinguish between <strong>Credibility Debt</strong> (shorter-term risks) and <strong>Credibility Cryptocurrency</strong> (longer-term risks) using your ‚ÄúDon‚Äôts‚Äù from Exercise 6.
  </div>

  <div class="container">
    <div class="left-pane">
      <img src="/page-91.jpg" alt="Exercise 12 Page 91" />
    </div>

    <div class="right-pane">
      <div class="card">
        <div class="instructions">
          <strong>Now we‚Äôre going to consider the credibility risks that can negatively impact your reputation bank.</strong>
          <p>
            See below the work you did in Exercise 6 on the ‚ÄúDon‚Äôts‚Äù of the Success Rules. Consider the difference between
            <strong>Credibility Debt</strong> (shorter-term reputation risk) and <strong>Credibility Cryptocurrency</strong>
            (longer-term reputation risk). Determine which of the ‚ÄúDon‚Äôts‚Äù are Credibility Debt and which are Credibility
            Cryptocurrency and type them in the appropriate spaces below. You‚Äôll need three of each type to move to the
            next exercises. If you don‚Äôt have enough of one type, it‚Äôs a good idea to go back to Exercise 6, Page 54 and
            re-consider your risks using this lens.
          </p>
          <p>
            <strong>Tip:</strong> You‚Äôve completed the positive side of the Reputation Bank ‚Äì Credibility Cash and Gold.
            Now, distinguish negative impacts based on how much repetitive harm could occur over time.
          </p>
        </div>

        <div class="reference-list" id="referenceList">
          <strong>Your Don‚Äôts from Exercise 6:</strong>
          <ul id="dontList"></ul>
        </div>

        <div class="section">
          <label>Credibility Debt (Hypothetical Shorter-Term Reputation Risks)</label>
          <textarea id="debt1" placeholder="Debt example #1"></textarea>
          <textarea id="debt2" placeholder="Debt example #2"></textarea>
          <textarea id="debt3" placeholder="Debt example #3"></textarea>
        </div>

        <div class="section">
          <label>Credibility Cryptocurrency (Hypothetical Longer-Term Reputation Risks)</label>
          <textarea id="crypto1" placeholder="Cryptocurrency example #1"></textarea>
          <textarea id="crypto2" placeholder="Cryptocurrency example #2"></textarea>
          <textarea id="crypto3" placeholder="Cryptocurrency example #3"></textarea>
        </div>

        <div class="button-group">
          <button type="button" onclick="goBack()">‚¨Ö Back One Page</button>
          <button type="button" onclick="saveData(false)">üíæ Save</button>
          <button type="button" onclick="saveData(true)">‚û° Save & Next</button>
          <button type="button" onclick="window.print()">üñ®Ô∏è Print</button>
          <button type="button" onclick="goToTOC()">Go to the Table of Contents</button>
        </div>

        <div id="status"></div>
      </div>
    </div>
  </div>

  <script>
    // ‚úÖ Shared Supabase client
    window.supabaseClient = window.supabaseClient || window.supabase.createClient(
      'https://nidxvthbowdgdfuopmzk.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5pZHh2dGhib3dkZ2RmdW9wbXprIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQxNTYwMjgsImV4cCI6MjA1OTczMjAyOH0.EaRbqF0WYFzYfjL5A6ykQKzHCZzCNPWJINIVwosqYk4'
    );
    const sb = window.supabaseClient;

    function setStatus(message, color = "#084a58") {
      const el = document.getElementById("status");
      el.textContent = message;
      el.style.color = color;
    }

    async function requireUserOrRedirect() {
      const { data } = await sb.auth.getUser();
      const user = data?.user;
      if (!user) {
        window.location.href = "/login.html";
        return null;
      }
      return user;
    }

    async function loadData() {
      const user = await requireUserOrRedirect();
      if (!user) return;

      // Load saved answers for page 91
      const { data: savedData, error: savedErr } = await sb
        .from('exercise12_page91')
        .select('debt1,debt2,debt3,crypto1,crypto2,crypto3')
        .eq('user_id', user.id)
        .maybeSingle();

      if (savedErr) {
        setStatus("‚ùå Could not load saved data:\n" + savedErr.message, "red");
      } else if (savedData) {
        document.getElementById('debt1').value = savedData.debt1 || '';
        document.getElementById('debt2').value = savedData.debt2 || '';
        document.getElementById('debt3').value = savedData.debt3 || '';
        document.getElementById('crypto1').value = savedData.crypto1 || '';
        document.getElementById('crypto2').value = savedData.crypto2 || '';
        document.getElementById('crypto3').value = savedData.crypto3 || '';
      }

      // Load Don‚Äôts from Exercise 6 (page 54)
      const { data: ex6, error: ex6Err } = await sb
        .from('exercise6_page54')
        .select(`
          success_dont_1, success_dont_2, success_dont_3, success_dont_4, success_dont_5,
          success_dont_6, success_dont_7, success_dont_8, success_dont_9, success_dont_10
        `)
        .eq('user_id', user.id)
        .maybeSingle();

      const dontList = document.getElementById('dontList');
      dontList.innerHTML = '';

      if (ex6Err) {
        const li = document.createElement('li');
        li.textContent = "Could not load Exercise 6 data: " + ex6Err.message;
        dontList.appendChild(li);
        return;
      }

      if (ex6) {
        for (let i = 1; i <= 10; i++) {
          const value = ex6[`success_dont_${i}`];
          if (value && value.trim() !== '') {
            const li = document.createElement('li');
            li.textContent = value;
            dontList.appendChild(li);
          }
        }
      }

      setStatus("‚úÖ Loaded saved data successfully.");
    }

    async function saveData(goNext = false) {
      const user = await requireUserOrRedirect();
      if (!user) return;

      setStatus("Saving...");

      const debts = ['debt1','debt2','debt3'].map(id => document.getElementById(id).value.trim());
      const cryptos = ['crypto1','crypto2','crypto3'].map(id => document.getElementById(id).value.trim());

      // Enforce 3 + 3 if going next
      if (goNext) {
        const debtFilled = debts.every(v => v.length > 0);
        const cryptoFilled = cryptos.every(v => v.length > 0);
        if (!debtFilled || !cryptoFilled) {
          setStatus('‚ùå Please enter three Credibility Debt items and three Credibility Cryptocurrency items before continuing.', "red");
          return;
        }
      }

      const updates = {
        user_id: user.id,
        debt1: debts[0],
        debt2: debts[1],
        debt3: debts[2],
        crypto1: cryptos[0],
        crypto2: cryptos[1],
        crypto3: cryptos[2],
      };

      const { error } = await sb
        .from('exercise12_page91')
        .upsert(updates, { onConflict: 'user_id' });

      if (error) {
        setStatus('‚ùå Error saving data:\n' + error.message, "red");
      } else {
        setStatus('‚úÖ Saved successfully!');
        if (goNext) window.location.href = '/#page/92';
      }
    }

    function goBack() { window.location.href = '/#page/90'; }
    function goToTOC() { window.location.href = '/page-3.html'; }

    document.addEventListener('DOMContentLoaded', loadData);
  </script>
</body>
</html>

