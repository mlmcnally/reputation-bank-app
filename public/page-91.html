<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Exercise 12 ‚Äì Page 91</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <style>
    body {
      font-family: sans-serif;
      background: #f3f4f6;
      margin: 0;
      padding: 0;
    }
    .container {
      display: flex;
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem;
    }
    .left {
      flex: 1;
      padding-right: 2rem;
    }
    .right {
      flex: 1;
      display: flex;
      flex-direction: column;
    }
    .instructions {
      margin-bottom: 1rem;
      background: #fff;
      padding: 1rem;
      border: 1px solid #ccc;
    }
    .section {
      margin-bottom: 1rem;
    }
    .reference-list {
      background: #eef2f7;
      padding: 0.5rem 1rem;
      border: 1px solid #ccc;
      margin-bottom: 1rem;
    }
    textarea {
      width: 100%;
      min-height: 60px;
      margin-bottom: 10px;
    }
    .button-bar {
      display: flex;
      justify-content: space-between;
      margin-top: 2rem;
    }
    button {
      padding: 0.5rem 1rem;
      font-size: 1rem;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="left">
      <img src="/page-91.jpg" alt="Exercise 12 Page 91" style="width: 100%; border: 1px solid #ccc;" />
    </div>
    <div class="right">
      <div class="instructions">
        <strong>Now we‚Äôre going to consider the credibility risks that can negatively impact your reputation bank.</strong>
        <p>See below the work you did in Exercise 6 on the ‚ÄúDon‚Äôts‚Äù of the Success Rules. Consider the difference between <strong>Credibility Debt</strong> (shorter-term reputation risk) and <strong>Credibility Cryptocurrency</strong> (longer-term reputation risk). Determine which of the ‚ÄúDon‚Äôts‚Äù are Credibility Debt and which are Credibility Cryptocurrency and type them in the appropriate spaces below. You‚Äôll need three of each type to move to the next exercises. If you don‚Äôt have enough of one type, it‚Äôs a good idea to go back to Exercise 6, Page 54 and re-consider your risks using this lens.</p>
        <p><strong>Tip:</strong> You‚Äôve completed the positive side of the Reputation Bank ‚Äì Credibility Cash and Gold. You‚Äôve seen how Credibility Gold can have exponentially more value than Credibility Cash based on delivering the right messages/interactions repetitively over time. Now you‚Äôre working on the same thing, except it reflects the negative potential impacts on your reputation bank. Distinguish between Credibility Debt and Cryptocurrency based on the amount of repetitive harm that could be done to your reputation over time.</p>
      </div>

      <div class="reference-list" id="referenceList">
        <strong>Your Don‚Äôts from Exercise 6:</strong>
        <ul id="dontList"></ul>
      </div>

      <div class="section">
        <label><strong>Credibility Debt</strong><br>(Hypothetical Shorter-Term Reputation Risks)</label>
        <textarea id="debt1"></textarea>
        <textarea id="debt2"></textarea>
        <textarea id="debt3"></textarea>
      </div>

      <div class="section">
        <label><strong>Credibility Cryptocurrency</strong><br>(Hypothetical Longer-Term Reputation Risks)</label>
        <textarea id="crypto1"></textarea>
        <textarea id="crypto2"></textarea>
        <textarea id="crypto3"></textarea>
      </div>

      <div class="button-bar">
        <button onclick="goBack()">‚¨Ö Back One Page</button>
        <button onclick="saveData()">üíæ Save</button>
        <button onclick="saveData(true)">‚û° Save & Go to Page 92</button>
        <button onclick="window.print()">üñ®Ô∏è Print</button>
      </div>
    </div>
  </div>

  <script>
    const supabase = supabase.createClient(
      'https://nidxvthbowdgdfuopmzk.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5pZHh2dGhib3dkZ2RmdW9wbXprIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQxNTYwMjgsImV4cCI6MjA1OTczMjAyOH0.EaRbqF0WYFzYfjL5A6ykQKzHCZzCNPWJINIVwosqYk4'
    );

    async function saveData(goNext = false) {
      const user = await supabase.auth.getUser();
      const user_id = user.data.user?.id;
      if (!user_id) return alert("User not logged in");

      const updates = {
        user_id,
        debt1: document.getElementById('debt1').value,
        debt2: document.getElementById('debt2').value,
        debt3: document.getElementById('debt3').value,
        crypto1: document.getElementById('crypto1').value,
        crypto2: document.getElementById('crypto2').value,
        crypto3: document.getElementById('crypto3').value,
      };

      const { error } = await supabase
        .from('exercise12_page91')
        .upsert(updates, { onConflict: ['user_id'] });

      if (error) {
        console.error('Save failed:', error.message);
        alert('Save failed: ' + error.message);
      } else {
        alert('Save successful!');
        if (goNext) window.location.href = '/#page/92';
      }
    }

    async function loadData() {
      const user = await supabase.auth.getUser();
      const user_id = user.data.user?.id;
      if (!user_id) return;

      // Load saved answers from page 91
      const { data: savedData } = await supabase
        .from('exercise12_page91')
        .select('*')
        .eq('user_id', user_id)
        .single();

      if (savedData) {
        document.getElementById('debt1').value = savedData.debt1 || '';
        document.getElementById('debt2').value = savedData.debt2 || '';
        document.getElementById('debt3').value = savedData.debt3 || '';
        document.getElementById('crypto1').value = savedData.crypto1 || '';
        document.getElementById('crypto2').value = savedData.crypto2 || '';
        document.getElementById('crypto3').value = savedData.crypto3 || '';
      }

      // Load Don‚Äôts from Exercise 6 (page 54)
      const { data: exercise6Data } = await supabase
        .from('exercise6_page54')
        .select('*')
        .eq('user_id', user_id)
        .single();

      const list = document.getElementById('dontList');
      list.innerHTML = '';
      if (exercise6Data) {
        for (let i = 1; i <= 10; i++) {
          const value = exercise6Data[`success_dont_${i}`];
          if (value) {
            const li = document.createElement('li');
            li.textContent = value;
            list.appendChild(li);
          }
        }
      }
    }

    function goBack() {
      window.location.href = '/#page/90';
    }

    loadData();
  </script>
</body>
</html>
